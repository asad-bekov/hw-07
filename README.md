
# Домашнее задание к занятию 3 «Резервное копирование»
*Асадбеков Асадбек*

## Задание 1

ЗСоставьте команду rsync, которая позволяет создавать зеркальную копию домашней директории пользователя в директорию `/tmp/backup`
Необходимо исключить из синхронизации все директории, начинающиеся с точки (скрытые)
Необходимо сделать так, чтобы rsync подсчитывал хэш-суммы для всех файлов, даже если их время модификации и размер идентичны в источнике и приемнике.
На проверку направить скриншот с командой и результатом ее выполнения  

#### Команда `rsync`
```
rsync -av --checksum --exclude='.*' ~/ /tmp/backup/
```
#### Пояснение:

`-a (archive mode)`: сохраняет права доступа, временные метки, символические ссылки и другие атрибуты файлов.

`-v (verbose)`: выводит подробную информацию о процессе синхронизации.

`--checksum`: проверяет хэш-суммы файлов вместо сравнения времени модификации и размера.

`--exclude='.*'`: исключает все файлы и директории, начинающиеся с точки (скрытые).

`~/`: исходная директория (домашняя директория пользователя).

`/tmp/backup/`: целевая директория, куда будет создана зеркальная копия.

### Скриншоты

**Cкриншот терминала с результатом выполнения команды:**

![](https://github.com/asad-bekov/hw-07/blob/main/img/img1.png)

---

## Задание 2

Написать скрипт и настроить задачу на регулярное резервное копирование домашней директории пользователя с помощью rsync и cron.
Резервная копия должна быть полностью зеркальной
Резервная копия должна создаваться раз в день, в системном логе должна появляться запись об успешном или неуспешном выполнении операции
Резервная копия размещается локально, в директории `/tmp/backup`
На проверку направить файл crontab и скриншот с результатом работы утилиты. 

### Ответ:

Скрипт работает корректно:
Резервная копия создаётся.
Логи содержат всю необходимую информацию.
Задача в cron настроена для ежедневного выполнения.

### Конфигурация backup_script.sh
```
#!/bin/bash

BACKUP_DIR="/tmp/backup"

mkdir -p "$BACKUP_DIR"

logger -t backup_script "Начато резервное копирование домашней директории в $BACKUP_DIR"

rsync -av --delete --exclude='.cache/' --exclude='.Trash/' ~/ "$BACKUP_DIR" 2>&1 | while read -r line; do
    logger -t backup_script "$line"
done &

wait $!

STATUS=$?
logger -t backup_script "Статус завершения rsync: $STATUS"

if [ $STATUS -eq 0 ]; then
    logger -t backup_script "Резервное копирование успешно завершено."
else
    logger -t backup_script "Ошибка при выполнении резервного копирования!"
fi

logger -t backup_script "Скрипт резервного копирования завершен."
```

### Скриншоты

**Вывод команды `crontab -l`:**

![](https://github.com/asad-bekov/hw-07/blob/main/img/img2.png)

**Вывод команды `sudo journalctl -t backup_script`:**

![](https://github.com/asad-bekov/hw-07/blob/main/img/img3.png)
---
![](https://github.com/asad-bekov/hw-07/blob/main/img/img4.png)

**Вывод команды `ls -l /tmp/backup`:**

![](https://github.com/asad-bekov/hw-07/blob/main/img/img5.png)
